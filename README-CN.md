# notebookLM 应用模块

该目录包含 “notebookLM” 应用的核心后端逻辑。这是一个强大的知识合成、思维导图构建及智能报告生成工具。

## 功能特性

1.  **动态笔记创建**: 用户可通过提供标题和一个或多个源文档来创建一个“笔记”。系统会处理这些文档，为其构建一个专属的、层次化的知识图谱，为后续所有功能奠定基础。

2.  **自动化思维导图生成**: 基于知识图谱，自动生成结构化的层次思维导图，为文档中的核心概念及其相互联系提供清晰的可视化概览。

3.  **简报（Brief）报告生成**: 一项非交互式功能，可自动生成一份简洁且结构良好的报告。它首先根据知识图谱中识别出的主要主题（社区）创建大纲，然后撰写完整的报告内容。

4.  **自定义报告生成 (交互式 Agent)**: 由基于 `LangGraph` 的 ReAct Agent 驱动的、先进的、有状态的功能。这使得报告撰写过程可以进行对话式和迭代式的交互：
    *   **用户驱动**: 用户提供报告标题和具体要求。
    *   **大纲审核**: Agent 会生成一份草稿大纲供用户审查。
    *   **迭代反馈**: 用户可以批准大纲或提供修改意见。Agent 将根据反馈重新生成大纲，直到满足用户需求。
    *   **最终报告生成**: 大纲一经批准，Agent 将继续撰写完整的报告，同样支持后续的审查和修改。

## 技术架构与优势

1.  **基于 `youtu-graphrag` 驱动**: 本应用的核心知识处理层采用了强大的 `youtu-graphrag` 引擎，这带来了：
    *   **层次化知识图谱**: 一个包含属性、关系、关键词和社区的多层图结构，既能捕捉细粒度的细节，也能揭示高层次的主题。
    *   **先进的检索能力**: 利用强大的多路检索引擎 (`KTRetriever` 和 `DualFAISSRetriever`)，实现高效、精准的信息查找。
    *   **动态 Schema 演化**: 系统可以在处理过程中通过演化知识 Schema，智能地适应和扩展其对内容的理解。

2.  **用于复杂任务的有状态 Agent**: 针对自定义报告功能，我们使用 `LangGraph` 构建了一个有状态的 Agent。与简单的 LLM 链相比，其显著优势在于：
    *   **人机协同 (Human-in-the-Loop)**: 流程可以暂停并等待用户输入，使生成过程真正实现交互式和可控。
    *   **可靠的多步逻辑**: 基于图的结构确保了带有条件逻辑（如修订）的复杂多步任务能够被可靠地执行。
    *   **模块化**: Agent 的决策逻辑与其使用的工具完全分离。

3.  **模块化与可扩展的设计**: `notebookLM` 模块被设计为一个独立的顶层应用，位于 `youtu-graphrag` 引擎之上。
    *   **清晰的权责分离**: API、服务、Agent 和工具被组织在职责分明的独立模块中。
    *   **抽象的工具层**: 一个专用的工具层作为 Agent 与底层检索引擎之间的适配器，使得在不改变 Agent 核心逻辑的情况下，可以轻松添加新功能或修改现有功能。

4.  **现代化的 API 设计**:
    *   **混合 API 策略**: 应用有效地为不同任务匹配了最合适的协议：
        *   **REST API**: 用于处理简单的、无状态的请求，如生成思维导图或简报。
        *   **WebSocket**: 用于处理自定义报告 Agent 所需的复杂的、有状态的实时通信。
    *   **Pydantic Schemas**: 所有的 API 输入和输出都通过 Pydantic 进行了严格的类型定义，确保了数据校验和清晰的 API 契约。

## 如何运行

1.  **确保 `youtu-graphrag` 已设置**: 确保根目录 `requirements.txt` 中的所有依赖项都已安装。
2.  **构建知识图谱**: 在使用 API 之前，您必须首先通过向 `/notes` 端点发送 POST 请求来创建一个笔记。这将构建必要的图谱和索引。（注意：请确保您的 `config/base_config.yaml` 文件已配置为可以处理您提供的 `note_name`）。
3.  **运行 FastAPI 服务器**:
    ```bash
    python notebookLM/main.py
    ```
4.  **与 API 交互**:
    *   在 `http://localhost:8000/docs` 访问自动生成的 API 文档。
    *   使用客户端与 REST 端点 (`/notebooklm/mindmap`, `/notebooklm/brief-report`) 交互。
    *   使用 WebSocket 客户端连接到 `/ws/report/custom/{session_id}` 来生成自定义报告。

## 致谢

本应用的核心知识图谱构建与检索引擎，是基于强大的开源项目 [youtu-graphrag](https://github.com/TencentCloudADP/youtu-graphrag) 构建的。我们在此向原作者团队的杰出工作及其对开源社区的贡献表示诚挚的感谢。 